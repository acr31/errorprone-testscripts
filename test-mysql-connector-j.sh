#!/bin/bash

if [ ! -e /home/errorprone/examples/jdk8/src/share/classes/java/sql/Connection.java ]; then
	echo "This test requires JDK source code. Please run test-jdk8.sh first"
	exit -1
fi

mkdir -p /home/errorprone/examples
cd /home/errorprone/examples
if [ ! -x mysql-connector-j ]; then
	git clone https://github.com/mysql/mysql-connector-j.git
	cd mysql-connector-j
	git checkout 1f61b0b0270d9844b006572ba4e77f19c0f230d4
	cd src/lib
	wget http://central.maven.org/maven2/junit/junit/3.8.1/junit-3.8.1.jar
	wget http://central.maven.org/maven2/org/hibernate/hibernate-core/4.2.21.Final/hibernate-core-4.2.21.Final.jar
	cd ..
else
	cd src
	rm -rf build
fi
mkdir build
/usr/lib/jvm/java-gcj-5/bin/javac -cp lib/c3p0-0.9.1-pre6.jar:lib/hibernate-core-4.2.21.Final.jar:lib/jboss-common-jdbc-wrapper.jar:lib/jboss-common-jdbc-wrapper-src.jar:lib/junit-3.8.1.jar:lib/slf4j-api-1.6.1.jar -d build ./com/mysql/jdbc/AbandonedConnectionCleanupThread.java ./com/mysql/jdbc/AssertionFailedException.java ./com/mysql/jdbc/authentication/MysqlClearPasswordPlugin.java ./com/mysql/jdbc/authentication/MysqlNativePasswordPlugin.java ./com/mysql/jdbc/authentication/MysqlOldPasswordPlugin.java ./com/mysql/jdbc/AuthenticationPlugin.java ./com/mysql/jdbc/authentication/Sha256PasswordPlugin.java ./com/mysql/jdbc/BalanceStrategy.java ./com/mysql/jdbc/BlobFromLocator.java ./com/mysql/jdbc/Blob.java ./com/mysql/jdbc/Buffer.java ./com/mysql/jdbc/BufferRow.java ./com/mysql/jdbc/ByteArrayRow.java ./com/mysql/jdbc/CacheAdapterFactory.java ./com/mysql/jdbc/CacheAdapter.java ./com/mysql/jdbc/CachedResultSetMetaData.java ./com/mysql/jdbc/CallableStatement.java ./com/mysql/jdbc/CharsetMapping.java ./com/mysql/jdbc/Clob.java ./com/mysql/jdbc/CommunicationsException.java ./com/mysql/jdbc/CompressedInputStream.java ./com/mysql/jdbc/ConnectionFeatureNotAvailableException.java ./com/mysql/jdbc/ConnectionGroup.java ./com/mysql/jdbc/ConnectionGroupManager.java ./com/mysql/jdbc/ConnectionImpl.java ./com/mysql/jdbc/Connection.java ./com/mysql/jdbc/ConnectionLifecycleInterceptor.java ./com/mysql/jdbc/ConnectionPropertiesImpl.java ./com/mysql/jdbc/ConnectionProperties.java ./com/mysql/jdbc/ConnectionPropertiesTransform.java ./com/mysql/jdbc/Constants.java ./com/mysql/jdbc/DatabaseMetaData.java ./com/mysql/jdbc/DatabaseMetaDataUsingInfoSchema.java ./com/mysql/jdbc/EscapeProcessor.java ./com/mysql/jdbc/EscapeProcessorResult.java ./com/mysql/jdbc/EscapeTokenizer.java ./com/mysql/jdbc/ExceptionInterceptor.java ./com/mysql/jdbc/exceptions/DeadlockTimeoutRollbackMarker.java ./com/mysql/jdbc/exceptions/MySQLDataException.java ./com/mysql/jdbc/exceptions/MySQLIntegrityConstraintViolationException.java ./com/mysql/jdbc/exceptions/MySQLNonTransientConnectionException.java ./com/mysql/jdbc/exceptions/MySQLNonTransientException.java ./com/mysql/jdbc/exceptions/MySQLQueryInterruptedException.java ./com/mysql/jdbc/exceptions/MySQLStatementCancelledException.java ./com/mysql/jdbc/exceptions/MySQLSyntaxErrorException.java ./com/mysql/jdbc/exceptions/MySQLTimeoutException.java ./com/mysql/jdbc/exceptions/MySQLTransactionRollbackException.java ./com/mysql/jdbc/exceptions/MySQLTransientConnectionException.java ./com/mysql/jdbc/exceptions/MySQLTransientException.java ./com/mysql/jdbc/ExportControlled.java ./com/mysql/jdbc/Extension.java ./com/mysql/jdbc/FailoverConnectionProxy.java ./com/mysql/jdbc/Field.java ./com/mysql/jdbc/IterateBlock.java ./com/mysql/jdbc/jmx/LoadBalanceConnectionGroupManager.java ./com/mysql/jdbc/jmx/LoadBalanceConnectionGroupManagerMBean.java ./com/mysql/jdbc/jmx/ReplicationGroupManager.java ./com/mysql/jdbc/jmx/ReplicationGroupManagerMBean.java ./com/mysql/jdbc/LicenseConfiguration.java ./com/mysql/jdbc/LoadBalancedConnection.java ./com/mysql/jdbc/LoadBalancedConnectionProxy.java ./com/mysql/jdbc/LoadBalancedMySQLConnection.java ./com/mysql/jdbc/LoadBalanceExceptionChecker.java ./com/mysql/jdbc/log/LogFactory.java ./com/mysql/jdbc/log/Log.java ./com/mysql/jdbc/log/LogUtils.java ./com/mysql/jdbc/log/NullLogger.java ./com/mysql/jdbc/log/StandardLogger.java ./com/mysql/jdbc/Messages.java ./com/mysql/jdbc/MultiHostConnectionProxy.java ./com/mysql/jdbc/MultiHostMySQLConnection.java ./com/mysql/jdbc/MySQLConnection.java ./com/mysql/jdbc/MysqlDataTruncation.java ./com/mysql/jdbc/MysqlDefs.java ./com/mysql/jdbc/MysqlErrorNumbers.java ./com/mysql/jdbc/MysqlIO.java ./com/mysql/jdbc/MysqlParameterMetadata.java ./com/mysql/jdbc/MysqlSavepoint.java ./com/mysql/jdbc/NamedPipeSocketFactory.java ./com/mysql/jdbc/NetworkResources.java ./com/mysql/jdbc/NonRegisteringDriver.java ./com/mysql/jdbc/NoSubInterceptorWrapper.java ./com/mysql/jdbc/NotImplemented.java ./com/mysql/jdbc/NotUpdatable.java ./com/mysql/jdbc/OperationNotSupportedException.java ./com/mysql/jdbc/OutputStreamWatcher.java ./com/mysql/jdbc/PacketTooBigException.java ./com/mysql/jdbc/ParameterBindings.java ./com/mysql/jdbc/PerConnectionLRUFactory.java ./com/mysql/jdbc/PerVmServerConfigCacheFactory.java ./com/mysql/jdbc/PingTarget.java com/mysql/jdbc/PreparedStatement.java ./com/mysql/jdbc/ProfilerEventHandlerFactory.java ./com/mysql/jdbc/profiler/ProfilerEventHandler.java ./com/mysql/jdbc/profiler/ProfilerEvent.java ./com/mysql/jdbc/ReflectiveStatementInterceptorAdapter.java ./com/mysql/jdbc/ReplicationConnectionGroup.java ./com/mysql/jdbc/ReplicationConnectionGroupManager.java ./com/mysql/jdbc/ReplicationConnection.java ./com/mysql/jdbc/ReplicationConnectionProxy.java ./com/mysql/jdbc/ReplicationMySQLConnection.java ./com/mysql/jdbc/ResultSetImpl.java ./com/mysql/jdbc/ResultSetInternalMethods.java ./com/mysql/jdbc/ResultSetMetaData.java ./com/mysql/jdbc/ResultSetRow.java ./com/mysql/jdbc/RowDataCursor.java ./com/mysql/jdbc/RowDataDynamic.java ./com/mysql/jdbc/RowData.java ./com/mysql/jdbc/RowDataStatic.java ./com/mysql/jdbc/Security.java ./com/mysql/jdbc/ServerPreparedStatement.java ./com/mysql/jdbc/SingleByteCharsetConverter.java ./com/mysql/jdbc/SocketFactory.java ./com/mysql/jdbc/SocketMetadata.java ./com/mysql/jdbc/SocksProxySocketFactory.java ./com/mysql/jdbc/SQLError.java ./com/mysql/jdbc/StandardSocketFactory.java ./com/mysql/jdbc/StatementImpl.java ./com/mysql/jdbc/StatementInterceptor.java ./com/mysql/jdbc/StatementInterceptorV2.java ./com/mysql/jdbc/Statement.java ./com/mysql/jdbc/StreamingNotifiable.java ./com/mysql/jdbc/StringUtils.java ./com/mysql/jdbc/TimeUtil.java ./com/mysql/jdbc/UpdatableResultSet.java ./com/mysql/jdbc/util/Base64Decoder.java ./com/mysql/jdbc/Util.java ./com/mysql/jdbc/util/LRUCache.java ./com/mysql/jdbc/util/ReadAheadInputStream.java ./com/mysql/jdbc/util/ResultSetUtil.java ./com/mysql/jdbc/V1toV2StatementInterceptorAdapter.java ./com/mysql/jdbc/WatchableOutputStream.java ./com/mysql/jdbc/WatchableWriter.java ./com/mysql/jdbc/Wrapper.java ./com/mysql/jdbc/WriterWatcher.java
/usr/bin/java -Xbootclasspath/p:/home/errorprone/error-prone/ant/target/error_prone_ant-2.0.21.jar com.google.errorprone.ErrorProneCompiler -XepDisableAllChecks -Xep:ArgumentSelectionDefectChecker:WARN -cp build -source 1.8 -target 1.8 com/mysql/jdbc/ServerPreparedStatement.java /home/errorprone/examples/jdk8/src/share/classes/java/sql/Connection.java
